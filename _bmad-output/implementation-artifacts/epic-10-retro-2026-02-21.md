# Retrospective: Epic 10 — Package, Publish & Integrations

**Date:** 2026-02-21
**Facilitator:** Bob (Scrum Master)
**Epic:** Epic 10 — Package, Publish & Integrations
**Status:** Complete (4/4 stories done, published to PyPI)

## Team Participants

- Bob (Scrum Master) — Facilitator
- Alice (Product Owner)
- Charlie (Senior Dev / Architect)
- Dana (QA Engineer)
- Elena (Junior Dev)
- Alberto-Codes (Project Lead)

## Epic Summary & Metrics

**Delivery:**

- Stories completed: 4/4 (100%)
- Test suite: 729 (stable — no source code changes in `src/docvet/`)
- Files created: ~12 new (LICENSE, README, CHANGELOG, action.yml, .pre-commit-hooks.yaml, py.typed, 3 workflows, 2 release-please configs)
- Files modified: pyproject.toml, README (iterative updates across stories)
- FRs completed: FR111, FR113, FR114, FR116, FR118, FR119, FR120, FR126, FR-G1, FR-G3, FR-G4 (11 FRs)
- NFRs satisfied: NFR55, NFR56, NFR59, NFR60, NFR61, NFR62 (6 NFRs)
- Wheel size: 38KB (well under 500KB NFR56 target)
- Published: PyPI v1.0.0, GitHub Release, `v1.0.0` and `v1` tags

**Quality:**

- Code review findings: 5 total (3 in 10.1, 2 in 10.4) — all enhancements, zero defects
- Debug sessions required: 0 (fifth consecutive zero-debug epic)
- Blockers encountered: 0
- Technical debt incurred: 0 new items
- Regressions: 0
- CI pipeline fixes during launch: 4 (permissions, OIDC token exchange, attest-action version, TestPyPI index config)

**Agent Models Used:**

- Stories 10.1, 10.2, 10.3, 10.4: Claude Opus 4.6

## Successes & Strengths

1. **Product shipped.** v1.0.0 live on PyPI — `pip install docvet` works. Professional PyPI listing with all classifiers, license, typed package marker, badge row, comparison table, and research-backed README.
2. **Fifth consecutive zero-debug epic.** Architecture spec investment continues to compound across 10 epics and 29 stories.
3. **All 4 stories completed in a single day** (2026-02-21). Progressive build pattern continued: metadata → README → integrations → pipeline. Zero backtracking.
4. **Research-backed README positioning.** "Better Docstrings, Better AI" section with 6 academic citations (NAACL 2024, ACL 2024, DORA 2025, Stack Overflow Blog 2026, Haroon et al. 2025, Li et al. 2025) — a real differentiator for the tool.
5. **Publish pipeline follows industry best practices.** OIDC trusted publishing (no API tokens), release-please for automated changelogs, floating `v1` tag for GitHub Action consumers, TestPyPI dry-run workflow.
6. **Code reviews continued catching quality improvements** — project URLs, `Typing :: Typed` classifier, `py.typed` marker, actions version bumps, smoke tests for test-publish. All enhancements, zero defects.
7. **Prep sprint between Epic 9 and 10 resolved tech debt.** Commit `c4be928` fixed circular import, reverted config suppressions, added Examples docstrings, and set up pre-commit hooks.
8. **SonarQube added to quality toolchain.** Local instance scanning `develop` via MCP server — new quality dimension for future epics.

## Challenges & Growth Areas

1. **Zero automated test coverage on packaging layer.** All 4 stories verified manually (YAML validation, rendering checks, wheel inspection). 729 tests cover source code, but packaging artifacts have no regression safety net.
2. **Story file status tracking inconsistency.** Stories 10.2 and 10.3 still marked `Status: review` in their files while sprint-status says `done`. Epic status still `in-progress`.
3. **Documentation/process retro items regressed again.** 2 of 6 Epic 9 action items dropped (`ty check` enforcement in story docs, foundational principle documentation). Third time this pattern has been flagged.
4. **Pipeline lessons only discoverable by running the pipeline.** Four CI fixes during launch that no code review would have caught — permissions inheritance, OIDC token exchange semantics, action version availability, index config requirements.
5. **Branch naming convention not standardized.** Dev agent has to manually determine conventional commit branch name from story context. Should be pre-computed in story template.

## Key Insights & Learnings

1. **Pipeline lessons are learned by running pipelines, not reading docs.** The 4 CI fixes during launch (OIDC `--index` vs `--publish-url`, `contents: read` permission inheritance, `attest-action@v0.0.4` not `@v1`, TestPyPI index in `pyproject.toml`) are the kind of knowledge that only comes from end-to-end execution.
2. **Retro action items need their own tracking mechanism.** Documentation and process items drop when they compete with feature work. Solution: a dedicated housekeeping epic with real stories and tracking.
3. **The create-story workflow is a leverage point.** Anything baked into the story template gets done by the dev agent automatically. Branch naming, quality gate lists, and conventions should be structural, not implied.
4. **SonarQube adds a quality dimension beyond ruff and pytest.** Cognitive complexity, code smells, and security hotspots — structural enforcement continues to win over good intentions.

## Previous Retro Follow-Through

**Epic 9 Action Items:**

| # | Action | Status | Evidence |
|---|--------|--------|----------|
| 1 | Enforce `ty check` as mandatory quality gate | ❌ Not addressed | Not listed in any Epic 10 story quality gates (pre-commit hook exists but story docs don't reference it) |
| 2 | Document foundational principle | ❌ Not addressed | No conventions file created |
| 3 | Resolve circular import in `checks/__init__.py` | ✅ Completed | Commit `c4be928` extracted Finding to own module |
| 4 | Revert `require-examples` config suppression | ✅ Completed | Commit `c4be928` added genuine Examples docstrings |
| 5 | Minimize `pyproject.toml` tool config footprint | ✅ Completed | Commit `c4be928` cleanup |
| 6 | Set up `.pre-commit-config.yaml` | ✅ Completed | Commit `c4be928` with 5 hooks |

**Score: 4/6 completed**

**Trend: 4/4 → 2/4 → 1/4 → 3/3 → 3/3 → 3/3 → 3/3 → 4/6 — perfect streak broken on documentation/process items**

## Technical Debt

No new technical debt incurred in Epic 10 (zero source code changes).

Carried forward from Epic 9 retro:

| # | Item | Priority | Status |
|---|------|----------|--------|
| 1 | `ty check` not enforced in story quality gate docs | MEDIUM | Carry to housekeeping epic |
| 2 | Foundational principle not documented | LOW | Carry to housekeeping epic |

## CI Pipeline Lessons (Publication Bumps)

| Fix | Lesson |
|-----|--------|
| `contents: read` permission | When declaring explicit workflow permissions, `contents` defaults to `none` — checkout fails without `contents: read` |
| `--index testpypi` vs `--publish-url` | `uv publish --publish-url` only sets the upload endpoint but mints the OIDC token against PyPI (wrong audience). Use `--index testpypi` for both token exchange and upload |
| TestPyPI index in `pyproject.toml` | `uv publish --index` requires the index to be defined in `pyproject.toml` with the correct `publish-url` |
| `attest-action` version | `astral-sh/attest-action@v1` does not exist. Pin to `@v0.0.4` (latest available release) |

## Action Items

| # | Action | Owner | Priority | Success Criteria |
|---|--------|-------|----------|-----------------|
| 1 | Mark `epic-10: done` in sprint-status.yaml | Bob (SM) | HIGH | Sprint-status reflects reality |
| 2 | Update story 10.2 and 10.3 status to `done` | Bob (SM) | HIGH | Story file status matches sprint-status |
| 3 | Update MEMORY.md with Epic 10 completion | Bob (SM) | HIGH | MEMORY.md reflects publication milestone |
| 4 | ~~Add branch protection on `main`~~ | Alberto-Codes | ~~HIGH~~ | ✅ Already done — repository ruleset `main-protection` active (deletion, non_fast_forward, pull_request) |
| 5 | ~~Verify merge commit setting for develop→main~~ | Alberto-Codes | ~~MEDIUM~~ | ✅ Already done — merge commits enabled for preserve conventional commits for release-please |
| 6 | Add `Branch` field to create-story workflow | Bob (SM) | HIGH | Every story includes pre-computed branch name |
| 7 | Document CI pipeline lessons in architecture/CLAUDE.md | Charlie (Senior Dev) | MEDIUM | 4 OIDC/permissions lessons captured |
| 8 | Create Housekeeping & Quality Infrastructure epic | Bob (SM) | HIGH | SonarQube cleanup + retro carry-forwards tracked |

## Team Agreements

- Retro carry-forward items get their own epic — no more relying on good intentions
- SonarQube integrated into quality workflow going forward
- Branch naming convention baked into create-story workflow (structural enforcement)
- Branch protection on `main` before next release
- Documentation/process items tracked with same rigor as code items

## Readiness Assessment

- Testing & Quality: ✅ 729 tests, all quality gates green
- Deployment: ✅ Live on PyPI v1.0.0, GitHub Release published
- Stakeholder Acceptance: ✅ Confirmed by Alberto-Codes
- Technical Health: ✅ No source code changes, pipeline validated end-to-end
- Unresolved Blockers: None
- Status Tracking: ✅ Updated during retro (epic-10: done, retrospective: done, story statuses corrected)

**Verdict:** Epic 10 complete. Product shipped to PyPI. Pipeline validated. Ready for Epic 11 (Documentation Site) in parallel with Housekeeping epic (SonarQube + retro carry-forwards).

## Significant Discoveries

**SonarQube integration** — new quality tool added to the project during Epic 10. Scanning `develop` via MCP server. Dominant finding is cognitive complexity (`S3776`, threshold 15). Does not change Epic 11 plan but adds a quality dimension tracked in the new Housekeeping epic.

**CI pipeline friction** — 4 fixes discovered during actual publication. These are documented above as pipeline lessons. No architectural assumptions proven wrong. Epic 11 plan remains sound.

No epic update required for Epic 11.

## Next Epic Preview

**Epic 11: Documentation Site & Rule Reference** — 3 stories (parallel with Housekeeping epic)

| Story | Description | Dependencies on Epic 10 |
|-------|-------------|----------------------|
| 11.1 | Documentation Site Scaffold and Core Pages | ✅ README content, CLI reference, badge URLs |
| 11.2 | Check Pages and Configuration Reference | ✅ All 4 checks implemented, config system stable |
| 11.3 | Rule Reference Pages (19 rules) | ✅ All 19 rules delivered, rule IDs stable |

**Housekeeping & Quality Infrastructure Epic** (parallel)

- SonarQube findings cleanup (cognitive complexity and others)
- `ty check` enforcement in story template docs
- Foundational principle documentation
- Other retro carry-forwards

All Epic 10 prerequisites for Epic 11 satisfied. No prep sprint needed.

## Project-Wide Summary (All 10 Epics)

| Epic | Layer | Module | Stories | Rules | Tests Added | Status |
|------|-------|--------|---------|-------|-------------|--------|
| 1 | 3 | enrichment | 7 | 5 | 284 | Done |
| 2 | 3 | enrichment | 2 | 2 | 52 | Done |
| 3 | 3 | enrichment | 2 | 3 | 79 | Done |
| 4 | 4 | freshness | 3 | 3 | 57 | Done |
| 5 | 4 | freshness | 3 | 2 | 56 | Done |
| 6 | 6 | coverage | 2 | 1 | 29 | Done |
| 7 | 5 | griffe | 2 | 3 | 60 | Done |
| 8 | — | reporting/CI | 3 | 0 | 61 | Done |
| 9 | — | dogfooding/API | 3 | 0 | 47 | Done |
| 10 | — | packaging/publish | 4 | 0 | 0 | Done |
| **Total** | | **5 modules** | **29** | **19** | **725** | |

---

*Retrospective facilitated by Bob (Scrum Master) on 2026-02-21*
