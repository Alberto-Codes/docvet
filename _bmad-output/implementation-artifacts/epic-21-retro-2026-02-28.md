# Retrospective: Epic 21 — CLI Output & User Experience

**Date:** 2026-02-28
**Facilitator:** Bob (Scrum Master)
**Epic:** Epic 21 — CLI Output & User Experience
**Status:** Complete (5/5 stories done)

## Team Participants

- Bob (Scrum Master) — Facilitator
- Alice (Product Owner)
- Charlie (Senior Dev / Architect)
- Dana (QA Engineer)
- Elena (Junior Dev)
- Alberto-Codes (Project Lead)

## Epic Summary & Metrics

**Delivery:**

- Stories completed: 5/5 (100%)
- Duration: ~1 day (all stories completed 2026-02-26)
- Test suite growth: 829 → 879 tests (+50 net)
- New test files: 0 (all tests added to existing files)
- Files modified: 3 source (`cli.py`, `config.py`, `reporting.py`), 7 doc pages, 3 test files
- Zero new runtime dependencies — stdlib only + existing typer

**Quality:**

- Debug sessions required: 0 (22nd+ consecutive zero-debug epic)
- Blockers encountered: 0
- Technical debt incurred: 0 new items
- Regressions: 0
- Code review (21.1): Changes Requested → Fixed → Approved (1 HIGH, 1 MEDIUM, 2 LOW)
- Code review (21.2): Changes Requested → Fixed → Approved (2 MEDIUM, 1 LOW)
- Code review (21.3): Changes Requested → Fixed → Approved (1 HIGH, 3 MEDIUM, 2 LOW)
- Code review (21.4): Changes Requested → Fixed → Approved (3 MEDIUM, 2 LOW)
- Code review (21.5): Approved with fixes (2 MEDIUM, 1 LOW)

**Agent Models Used:**

- Stories 21.1–21.5: Claude Opus 4.6

## Successes & Strengths

1. **Product identity breakthrough.** The "Vetted" brand verb, chosen through party mode competitive analysis, transforms docvet's first impression. No other Python tool uses it — it's the verb form of the product name, reinforced in every terminal session. The three-tier output model (quiet/default/verbose) follows clig.dev best practices and communicates that the tool was designed with intention.
2. **Pattern reuse at scale.** Story 21.3 established the dual-registration + format_summary + ctx.obj resolution pattern for `check`. Story 21.4 applied it mechanically to all four individual subcommands with zero deviation. The "Previous Story Intelligence" forward-carry sections eliminated rediscovery across all stories.
3. **Code review catching real bugs.** Story 21.3's H1 finding was a functional order-of-operations bug — `_discover_and_handle` was called before verbose/quiet resolution, meaning the file count message wasn't gated properly. This passed all tests and would have shipped without adversarial review.
4. **100% previous retro follow-through.** All three Epic 20 agreements were applied: "What NOT to Change" pattern (21.3, 21.4), code review gaps as a feature (all stories), forward-carry (all stories after 21.1).
5. **Polish epics execute fast on stable foundations.** Five stories in one day was only possible because the CLI architecture from Epics 1-19 was solid — `_output_and_exit` pipeline, stream separation discipline, `format_summary` abstraction. Building on rock, not sand.
6. **Story 21.5 required zero source code changes.** Stories 21.1-21.4 cleaned up stale test assertions during implementation, so the dedicated test migration story was purely docs and edge-case tests. Each story cleaned up after itself.

## Challenges & Growth Areas

1. **Documentation drift across stories.** CLI behavior changed in `cli.py` but docs in `docs/site/` lagged — caught in review twice (21.2: two stale doc pages, 21.5: CLI help text vs reference page mismatch). The story template's "Documentation Impact" section provides awareness, and review catches the drift. No process change needed — the cost is low (5-minute review fixes) and the existing mechanism is working.
2. **Typer context propagation testing gaps.** Story 21.3's H1 bug passed all tests because mock setups didn't fully exercise `ctx.obj` ordering. This is inherent to how typer context works in test runners — not easily solved with a process change. Review remains the defense.

## Key Insights & Learnings

1. **Product identity matters as much as functionality.** The shift from "does it work?" to "does it feel like a product?" is a meaningful maturity marker. Research-driven design decisions (party mode competitive analysis) eliminated guesswork and produced a distinctive brand voice.
2. **Forward-carry is the highest-leverage practice in the project.** It compounds across stories within an epic. 21.4 was mechanical application of 21.3's proven pattern — zero rediscovery, zero deviation, zero bugs in the replicated code. The practice has been validated across five consecutive epics.
3. **Code review is irreplaceable for ordering and interaction bugs.** The implementer can't see their own blind spots. 21.3's H1 proves that even with thorough tests, functional bugs in execution ordering can slip through. Multi-perspective review is the intended mechanism — not "be more careful."

## Previous Retro Follow-Through

**Epic 20 Team Agreements:**

1. Continue "What NOT to Change" pattern in Dev Notes: **Applied** — 21.3 and 21.4 include explicit lists of untouchable code
2. Code review test gap findings are a feature, not a bug: **Applied** — all 5 stories had review findings, all treated as healthy workflow
3. Continue "Previous Story Intelligence" forward-carry: **Applied** — every story after 21.1 has explicit forward-carry section

**Trend: 4/4 → 2/4 → 1/4 → 3/3 → 3/3 → 3/3 → 3/3 → 4/6 → 7/8 → 2/2 → 0/2 → 0/1 → 2/4 → 2/2 → N/A → N/A → N/A → N/A → 3/3**

**Analysis:** First scored result after four consecutive N/As. Perfect follow-through on all three agreements from Epic 20. The practices (forward-carry, review-as-defense, What NOT to Change) are now standard — no longer needing enforcement, just continuation.

## Technical Debt

No new technical debt incurred in Epic 21. No carried items remaining.

## Action Items

None. Epic was clean, existing mechanisms are working, no process changes needed.

## Team Agreements

1. **Forward-carry is standard practice.** Every story after the first in an epic includes a "Previous Story Intelligence" section. Validated across five consecutive epics. No enforcement needed.
2. **Code review catches what tests can't.** Multi-perspective review (adversarial, party mode, bot comments) is the intended mechanism for ordering bugs, edge cases, and documentation drift. Not a process failure — a process feature.
3. **Research before coding for product-facing decisions.** Party mode competitive analysis produced the "Vetted" brand verb and three-tier model with zero trial-and-error. Front-load knowledge for UX and design decisions.

## Next Epic Preview

**Epic 22: Discoverable and Understandable** (5 stories)

- Story 22.1: Add How-to-Fix Guidance to All 19 Rule Pages
- Story 22.2: Rewrite README with AI Agent Section and Competitive Positioning
- Story 22.3: Create agents.md for Cross-Tool Agent Discovery
- Story 22.4: Create CONTRIBUTING.md Contributor Guide
- Story 22.5: Audit and Expand Discoverability Metadata
- Dependencies on Epic 21: Minimal — CLI reference pages updated in 21.5, no code dependencies
- Preparation needed: None

*Note: This retro was run retroactively. Epic 22 is already complete at time of review. No preparation discussion needed — subsequent epic shipped without issues.*

## Readiness Assessment

- Testing & Quality: All gates green, 879 tests passing, zero regressions
- Deployment: Three-tier output model available in production
- Stakeholder Acceptance: Confirmed by Alberto-Codes
- Technical Health: Solid — stream separation discipline maintained, pattern reuse proven
- Unresolved Blockers: None

**Verdict:** Epic 21 fully complete. CLI output transformed from silent/noisy to branded/intentional. Three-tier model (quiet/default/verbose) working across all commands. "Vetted" brand verb established. No dependencies or blockers surfaced.

---

*Retrospective facilitated by Bob (Scrum Master) on 2026-02-28*
