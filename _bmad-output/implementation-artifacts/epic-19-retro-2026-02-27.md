# Retrospective: Epic 19 — Advanced Exclude Patterns

**Date:** 2026-02-27
**Facilitator:** Bob (Scrum Master)
**Epic:** Epic 19 — Advanced Exclude Patterns
**Status:** Complete (2/2 stories done)

## Team Participants

- Bob (Scrum Master) — Facilitator
- Alice (Product Owner)
- Charlie (Senior Dev / Architect)
- Dana (QA Engineer)
- Elena (Junior Dev)
- Alberto-Codes (Project Lead)

## Epic Summary & Metrics

**Delivery:**

- Stories completed: 2/2 (100%)
- FRs completed: FR1-FR7 (all 7 functional requirements)
- NFRs satisfied: NFR1-NFR5
- Duration: ~2 days (2026-02-25 to 2026-02-26)
- Files modified: 4 (`src/docvet/discovery.py`, `tests/unit/test_discovery.py`, `tests/integration/test_discovery.py`, `docs/site/configuration.md`)
- Tests added: 33 new (23 unit + 10 integration), suite total 762 → 795
- Zero new runtime dependencies — stdlib only (`fnmatch` + `pathlib`)

**Quality:**

- Debug sessions required: 0 (16th consecutive zero-debug epic)
- Blockers encountered: 0
- Technical debt incurred: 0 new items
- Regressions: 0
- Code review (19.1): Changes Requested → Fixed → Approved (1 HIGH, 2 MEDIUM, 2 LOW)
- Code review (19.2): Not recorded in story file (backlog retro — process has since tightened)

**Agent Models Used:**

- Story 19.1: Claude Opus 4.6
- Story 19.2: Claude Opus 4.6

## Successes & Strengths

1. **Sharp scope and clean execution.** Two stories, zero debug sessions, 33 new tests. The extend-exclude foundation from Epic 16 meant zero config.py changes — all work contained in discovery.py, tests, and docs.
2. **Critical assumption caught during implementation.** The epics doc and Epic 18's retro both stated `PurePath.full_match()` was Python 3.12+. The dev verified on actual Python 3.12.12 and found it's 3.13+ only. Pivoted to `fnmatch` with zero-segment fallbacks — stdlib-only, works on 3.12+.
3. **Code review on 19.1 delivered real value.** Caught `_is_excluded` at CC=27 (nearly double SonarQube threshold of 15). Refactored to extracted `_matches_trailing_slash()` and `_matches_double_star()` helpers, bringing CC down to ~9.
4. **"What NOT to Change" pattern carried forward.** Both stories included explicit sections listing what should NOT be modified, preventing scope creep. Validates the team agreement from Epic 18.
5. **Zero new runtime dependencies.** Solution uses stdlib only (`fnmatch` and `pathlib.PurePosixPath`). No dependency bloat for a feature enhancement.
6. **Behavioral improvement, not just new feature.** Trailing-slash and double-star patterns that previously silently failed now work correctly. Documented as a net improvement in the PR.

## Challenges & Growth Areas

1. **Story 19.2 code review section left blank.** Story file shows `Status: review` with empty Code Review section, but sprint-status marks it `done`. Accepted — this is a backlog retro and the team has consistently maintained review discipline since.
2. **Incorrect technical assumption propagated across artifacts.** `PurePath.full_match()` availability was stated as 3.12+ in the epics doc and repeated in Epic 18's retro preview. Caught at implementation time, not after shipping. The system worked where it mattered.

## Key Insights & Learnings

1. **Planning previews are hypotheses, not facts.** The `full_match()` assumption was repeated across two artifacts without verification. Always verify technical assumptions against actual runtime before relying on them in implementation.
2. **The `fnmatch` zero-segment fallback pattern is reusable.** `fnmatch` treats `**` as `*` (matches any characters including `/`), handling 1+ segments. The zero-segment fallback (strip `**/` prefix or collapse `/**/` to `/`) handles the edge case. This pattern applies anywhere recursive glob semantics are needed on Python 3.12.
3. **Behavioral fixes deserve PR documentation.** When patterns that previously silently failed start working correctly, that's a net improvement — but worth calling out explicitly so users understand the change.

## Previous Retro Follow-Through

**Epic 18 Action Items:** None (clean epic, no action items set)

**Epic 18 Team Agreement:**
- Continue "What NOT to Change" pattern in Dev Notes: **Applied** in both stories 19.1 and 19.2

**Trend: 4/4 → 2/4 → 1/4 → 3/3 → 3/3 → 3/3 → 3/3 → 4/6 → 7/8 → 2/2 → 0/2 → 0/1 → 2/4 → 2/2 → N/A → N/A → N/A**

**Analysis:** Third consecutive N/A — small, clean epics (17, 18, 19) generating no action items. The trend is meaningful only across meatier epics.

## Technical Debt

No new technical debt incurred in Epic 19. No carried items remaining.

## Action Items

None. Epic was clean, no process changes needed. Identified gaps (19.2 review, assumption propagation) are already addressed by current team practices.

## Team Agreements

1. **Continue "What NOT to Change" pattern in Dev Notes.** Now validated across three consecutive epics (17, 18, 19). Standard practice.
2. **Mark retrospective next-epic previews as unverified when technical assumptions haven't been hands-on tested.** Prevents propagation of incorrect assumptions across artifacts.

## Next Epic Preview

**Epic 20: CLI Progress & Timing** (2 stories)

- Story 20.1: Progress bar for file processing
- Story 20.2: Per-check timing and total execution time
- Dependencies on Epic 19: None
- Preparation needed: None

*Note: This retro was run retroactively. Epics 20-22 are already complete at time of review. No preparation discussion needed — subsequent epics shipped without issues.*

## Readiness Assessment

- Testing & Quality: All gates green, 795 tests passing, zero regressions
- Deployment: Advanced exclude patterns available in production
- Stakeholder Acceptance: Confirmed by Alberto-Codes
- Technical Health: Solid — clean 4-branch dispatch pattern, well-tested
- Unresolved Blockers: None

**Verdict:** Epic 19 fully complete. Trailing-slash and double-star exclude patterns working correctly across all discovery modes. No dependencies or blockers surfaced in subsequent epics (20-22).

---

*Retrospective facilitated by Bob (Scrum Master) on 2026-02-27*
